---
title: "Приведение типов в JavaScript"
date: 2023-04-10T16:08:57+03:00
draft: ✅
---

# Приведение типов в JavaScript

### Явное и неявное преобразование

​	Так как JavaScipt является слаботипизируемым языком с диначической типизацией, то приведение типов может происходить явно и неявно.

**Явное** преобразование типов

```js
const a = '0';
const b = Number(a);
```

В данном случае мы явно указываем, в какой тип мы хотим преобразовать переменную.

​	**Неявное** преобрзование типов происходит, как ни странно, неявно. Чаще всего неявно приеведение типов происходит при применении операторов к различным типам, например:  `1 == '1'`, `1 + '1'`, `1 - '1'`
Также важную роль играет контекст, например в `if (value){...}` `value` будет приведён к булевому значению.

У неявного преобразования есть как свои плюсы, так и минусы. К плюсам можно отнести тот факт, что данный механизм позволяет писать меньше кода. К минусам же относится тот факт, что наш код становится **менее предсказуемым**.

### Строгое и нестрогое сравнения

В JavaScipt существует 2 способа провести сравнения: строго и нестрого

```javascript
'0' == 0; // true
'0' === 0; // false 
```

Пример таблицы сравнений **==** и **===**. Более подробно можно ознакомиться [тут](https://dorey.github.io/JavaScript-Equality-Table/).

| x                 | y         |  ==   |  ===  |
| :---------------- | :-------- | :---: | :---: |
| undefiend         | undefiend | ✅ | ✅  |
| null              | null      | ✅  | ✅  |
| true              | true      | ✅  | ✅  |
| false             | false     | ✅  | ✅  |
| 'foo'             | 'foo'     | ✅  | ✅  |
| +0                | -0        | ✅  | ✅  |
| +0                | 0         | ✅  | ✅  |
| -0                | 0         | ✅  | ✅  |
| 0                 | false | ✅  | ❌ |
| ""                | false | ✅  | ❌ |
| ""                | 0         | ✅  | ❌ |
| '0'               | 0         | ✅  | ❌ |
| '17'              | 17        | ✅  | ❌ |
| [1,2]             | '1,2'     | ✅  | ❌ |
| new String('foo') | 'foo'     | ✅  | ❌ |
| null              | undefiend | ✅  | ❌ |



### Три типа конвертации

Всего в JavaScript можно выполнить преобразование к 3 типам:

- String
- Number
- Boolean

Логика преобразования для примитивов и объектов работает по-разному, но приведение можно выполнить только к выше перечисленным типам.



### Преобразование к строке

Для явного приведения к строке необходимо применить функцию `String()`. Неявное приведение будет вызвано бинарным оператором `+`, если один из операндов является строкой.

```js
String(123) // явно
123 + ''    // неявно
String(123)                   // '123'
String(-12.3)                 // '-12.3'
String(null)                  // 'null'
String(undefined)             // 'undefined'
String(true)                  // 'true'
String(false)                 // 'false'
```

Исключением является тип **Symbol**, его можно привести к строке только явным способом. Попытка привести его неявным способом вызовет ошибку.

```js
String(Symbol('my symbol'))   // 'Symbol(my symbol)'
'' + Symbol('my symbol')      // TypeError is thrown	
```



### Приведение к булеву значению

Для явного приведения к строке необходимо применить функцию `Boolean()`. Неявное преобразование происходит в логическом контексте  `if (value){...}`, или при применении следующих операторов: `||`, `&&`, `!`, `!!`.

```js
Boolean(2)          // явно
if (2) { ... }      // неявно
!!2                 // неявно
2 || 'hello'        // неявно
```



Несмотря на то, что операторы `||` и `&&` производят булево преобразование под капотом, возвращают они исходное значение.

```js
2 || 'test' // 2
'test' || 2 // 'test'
```

Существует список всегда ложных значений 

```js
Boolean('')           // false
Boolean(0)            // false     
Boolean(-0)           // false
Boolean(NaN)          // false
Boolean(null)         // false
Boolean(undefined)    // false
Boolean(false)        // false
```

Все остальные значение будут преобразованы в `true`

### Приведение к числовому значению

Для явного преобразования необходимо применить функцию `Nubmber()`, для неявного преобразования существует несколько способов:

- использование операторов сравнения - `>`, `<`, `<=`,`>=`
- использование бинарных операторов - `|` `&` `^` `~`
- использование арифметических операторов - `-` `+` `*` `/` `%`, при условии что с использованием бинарного опертора `+` не будет операндов со строкой.
- использование унарного оператора `+` (является самым быстрым способом привести к числовому значению)
- использование оператора нестрого неравенства `==` при условии, что 1 из операндов явялется числом

```js
Number('123')   // явно
+'123'          // неявно
123 != '456'    // неявно
4 > '5'         // неявно
5/null          // неявно
true | 0        // неявно

Number(null)                   // 0
Number(undefined)              // NaN
Number(true)                   // 1
Number(false)                  // 0
Number(" 12 ")                 // 12
Number("-12.34")               // -12.34
Number("\n")                   // 0
Number(" 12s ")                // NaN
Number(123)                    // 123
```

При преобразовании строки в число, движок сначала отсекает все пробельные символы, символы `\n`, и `\t` в начале и в конце строки, и возвращает `NaN` если обрезанная строка не представляет из себя корректное число. Если строка окажется пустой, то результатом будет `0`.

`null` и `undefined` обрабатываются по разному: `null` станет `0`, в то время как `undefined` станет `NaN`.

Существует 2 специальных правила:

1. При применении `==` к `null` или `undefined`, численное преобразование не происходит, так как `null` может равняться только `null` или `undefined`, и ничему другому.
2. `NaN` не равен ничему, даже самому себе.



### Преобразование типов для объектов

Когда происходит преобразование типов у объектов, то сначала происходит преобразование к примитивам, а после проиходит финальное преобразование.

При преобразовании к `Boolean` любое не примитивное значение будет приводиться к `true`. 

Объекты приводятся к примитивам посредством вызова внутреннего метода `[[ToPrimitive]]`, который отвечает как за численное, так и за строковое преобразование.

https://medium.com/@sergeybulavyk/%D0%BF%D1%80%D0%B5%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D1%82%D0%B8%D0%BF%D0%BE%D0%B2-%D0%B2-javascript-35a15ddfc333
